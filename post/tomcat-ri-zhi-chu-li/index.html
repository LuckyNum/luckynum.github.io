
<!DOCTYPE html>
<html>
  <head>
    
<meta charset="utf-8" >

<title>Tomcat - æ—¥å¿—å¤„ç† | ATOZ</title>
<meta name="description" content="Hello, World!">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://luckynum.github.io/favicon.ico?v=1555991330258">
<link rel="stylesheet" href="https://luckynum.github.io/styles/main.css">



<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



  </head>
  <body>
    <div id="app" class="main">
      <div class="site-header-container">
  <div class="site-header">
    <div class="left">
      <a href="https://luckynum.github.io">
        <img class="avatar" src="https://luckynum.github.io/images/avatar.png?v=1555991330258" alt="" width="32px" height="32px">
      </a>
      <a href="https://luckynum.github.io">
        <h1 class="site-title">ATOZ</h1>
      </a>
    </div>
    <div class="right">
      <transition name="fade">
        <i class="icon" :class="{ 'icon-close-outline': menuVisible, 'icon-menu-outline': !menuVisible }" @click="menuVisible = !menuVisible"></i>
      </transition>
    </div>
  </div>
</div>

<transition name="fade">
  <div class="menu-container" style="display: none;" v-show="menuVisible">
    <div class="menu-list">
      
        
          <a href="/" class="menu purple-link">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="menu purple-link">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="menu purple-link">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="menu purple-link">
            å…³äº
          </a>
        
      
        
          <a href="/post/music/" class="menu purple-link">
            éŸ³ä¹ğŸµ
          </a>
        
      
    </div>
  </div>
</transition>


      <div class="content-container">
        <div class="post-detail">
          
            <div class="feature-container" style="background-image: url('https://tomcat.apache.org/res/images/tomcat.png')">
            </div>
          
          <h2 class="post-title">Tomcat - æ—¥å¿—å¤„ç†</h2>
          <div class="post-info post-detail-info">
            <span><i class="icon-calendar-outline"></i> 2019-04-23</span>
            
              <span>
                <i class="icon-pricetags-outline"></i>
                
                  <a href="https://luckynum.github.io/tag/3tLqYheHY">
                    tomcat
                    
                  </a>
                
              </span>
            
          </div>
          <div class="post-content">
            <h2 id="tomcatæ—¥å¿—è¯¦è§£">tomcatæ—¥å¿—è¯¦è§£</h2>
<h3 id="1-tomcat-æ—¥å¿—é…ç½®æ–‡ä»¶">1.  tomcat æ—¥å¿—é…ç½®æ–‡ä»¶</h3>
<p><strong>tomcat å¯¹åº”æ—¥å¿—çš„é…ç½®æ–‡ä»¶</strong>ï¼štomcatç›®å½•ä¸‹çš„/conf/logging.propertiesã€‚</p>
<p>**tomcat çš„æ—¥å¿—ç­‰çº§æœ‰ï¼š**æ—¥å¿—è¾“å‡ºçº§åˆ«ï¼šSEVERE (æœ€é«˜çº§åˆ«) &gt; WARNING &gt; INFO &gt; CONFIG &gt; FINE &gt; FINER(ç²¾å¿ƒ) &gt; FINEST (æ‰€æœ‰å†…å®¹,æœ€ä½çº§åˆ«)</p>
<p>**tomcat  æœ‰äº”ç±»æ—¥å¿— ï¼š**catalinaã€localhostã€managerã€adminã€host-manager</p>
<p><code>conf/logging.properties</code> é…ç½®æ–‡ä»¶</p>
<h3 id="2-tomcatæ—¥å¿—æ–‡ä»¶è¯¦è§£">2. tomcatæ—¥å¿—æ–‡ä»¶è¯¦è§£</h3>
<p>**tomcat  æœ‰äº”ç±»æ—¥å¿— ï¼š**catalinaã€localhostã€managerã€adminã€host-manager</p>
<h4 id="catalinaout">catalina.out</h4>
<p>catalina.outå³æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†å‡ºé”™ï¼Œæ‰€æœ‰è¾“å‡ºåˆ°è¿™ä¸¤ä¸ªä½ç½®çš„éƒ½ä¼šè¿›å…¥catalina.outï¼Œè¿™é‡ŒåŒ…å«tomcatè¿è¡Œè‡ªå·±è¾“å‡ºçš„æ—¥å¿—ä»¥åŠåº”ç”¨é‡Œå‘consoleè¾“å‡ºçš„æ—¥å¿—ã€‚é»˜è®¤è¿™ä¸ªæ—¥å¿—æ–‡ä»¶æ˜¯ä¸ä¼šè¿›è¡Œè‡ªåŠ¨åˆ‡å‰²çš„ï¼Œæˆ‘ä»¬éœ€è¦å€ŸåŠ©å…¶ä»–å·¥å…·è¿›è¡Œåˆ‡å‰²ï¼ˆæ³¨æ„ï¼šcatalina.outæ–‡ä»¶å¦‚æœè¿‡å¤§ä¼šå½±å“ï¼‰</p>
<h4 id="catalinayyyy-mm-ddlog">catalina.YYYY-MM-DD.log</h4>
<p>catalina.{yyyy-MM-dd}.logæ˜¯tomcatè‡ªå·±è¿è¡Œçš„ä¸€äº›æ—¥å¿—ï¼Œè¿™äº›æ—¥å¿—è¿˜ä¼šè¾“å‡ºåˆ°catalina.outï¼Œä½†æ˜¯åº”ç”¨å‘consoleè¾“å‡ºçš„æ—¥å¿—ä¸ä¼šè¾“å‡ºåˆ°catalina.{yyyy-MM-dd}.log,å®ƒæ˜¯tomcatçš„å¯åŠ¨å’Œæš‚åœæ—¶çš„è¿è¡Œæ—¥å¿—ï¼Œ<strong>æ³¨æ„ï¼Œå®ƒå’Œcatalina.outæ˜¯é‡Œé¢çš„å†…å®¹æ˜¯ä¸ä¸€æ ·çš„ã€‚</strong></p>
<h4 id="localhostyyyy-mm-ddlog">**localhost.**YYYY-MM-DD.log</h4>
<p>localhost.{yyyy-MM-dd}.logä¸»è¦æ˜¯åº”ç”¨åˆå§‹åŒ–(listener, filter, servlet)æœªå¤„ç†çš„å¼‚å¸¸æœ€åè¢«tomcatæ•è·è€Œè¾“å‡ºçš„æ—¥å¿—,å®ƒä¹Ÿæ˜¯åŒ…å«tomcatçš„å¯åŠ¨å’Œæš‚åœæ—¶çš„è¿è¡Œæ—¥å¿—,ä½†å®ƒæ²¡æœ‰catalina.2018-09-19.log æ—¥å¿—å…¨ã€‚å®ƒåªæ˜¯è®°å½•äº†éƒ¨åˆ†æ—¥å¿—ã€‚</p>
<h4 id="localhost_access_logyyyy-mm-ddtxt">localhost_access_log.YYYY-MM-DD.txt</h4>
<p>localhost_access_log.2018-09-19.txtï¼šè¿™ä¸ªæ˜¯è®¿é—®tomcatçš„æ—¥å¿—ï¼Œè¯·æ±‚æ—¶é—´å’Œèµ„æºï¼ŒçŠ¶æ€ç éƒ½æœ‰è®°å½•ã€‚</p>
<h4 id="host-manageryyyy-mm-ddlog">host-manager.YYYY-MM-DD.log</h4>
<p>host-manager.2018-09-19.logï¼šè¿™ä¸ªä¼°è®¡æ˜¯æ”¾tomcatçš„è‡ªå¸¦çš„manageré¡¹ç›®çš„æ—¥å¿—ä¿¡æ¯çš„ï¼Œæœªçœ‹åˆ°æœ‰ä»€ä¹ˆé‡è¦çš„æ—¥å¿—ä¿¡æ¯ã€‚</p>
<h4 id="manageryyyy-mm-ddlog"><strong>manager.YYYY-MM-DD.log</strong></h4>
<p>manager.2018-09-19.log  ï¼šã€€è¿™ä¸ªæ˜¯tomcat manageré¡¹ç›®ä¸“æœ‰çš„æ—¥å¿—æ–‡ä»¶.</p>
<h2 id="tomcatæ—¥å¿—åˆ‡å‰²-æ¸…ç†">tomcatæ—¥å¿—åˆ‡å‰²ã€æ¸…ç†</h2>
<h3 id="1-åˆ‡å‰²å·¥å…·cronolog">1. åˆ‡å‰²å·¥å…·cronolog</h3>
<p>Cronologæ˜¯ä¸€ä¸ªè¿‡æ»¤å™¨ç¨‹åºï¼Œå®ƒä»æ ‡å‡†è¾“å…¥è¯»å–æ—¥å¿—æ–‡ä»¶æ¡ç›®ï¼Œå¹¶å°†æ¯ä¸ªæ¡ç›®å†™å…¥ç”±æ–‡ä»¶åæ¨¡æ¿å’Œå½“å‰æ—¥å¿—æ‰€æŒ‡å®šçš„è¾“å‡ºæ–‡ä»¶ä¸­ã€‚ å½“æ‰©å±•æ–‡ä»¶åæ”¹å˜æ—¶ï¼Œå…³é—­å½“å‰æ–‡ä»¶ï¼Œå¹¶æ‰“å¼€ä¸€ä¸ªæ–°æ–‡ä»¶ã€‚ Cronologæ˜¯ä¸ºäº†ä¸Apacheç­‰WebæœåŠ¡å™¨ä¸€èµ·ä½¿ç”¨ï¼Œå°†è®¿é—®æ—¥å¿—åˆ†ä¸ºæ¯æ—¥æˆ–æ¯æœˆæ—¥å¿—ã€‚</p>
<h4 id="cronologçš„å®‰è£…">cronologçš„å®‰è£…</h4>
<ul>
<li>ä¸‹è½½cronolog</li>
</ul>
<pre><code class="language-bash">[root@kafka01 src]# cd /usr/local/src
[root@kafka01 src]# wget https://files.cnblogs.com/files/crazyzero/cronolog-1.6.2.tar.gz
[root@kafka01 src]# md5sum cronolog-1.6.2.tar.gz
a44564fd5a5b061a5691b9a837d04979  cronolog-1.6.2.tar.gz         #&lt;==cronologçš„MD5ç 
</code></pre>
<ul>
<li>ç¼–è¯‘å®‰è£…</li>
</ul>
<pre><code class="language-bash">[root@kafka01 src]# tar xf cronolog-1.6.2.tar.gz
[root@kafka01 src]# cd cronolog-1.6.2
[root@kafka01 cronolog-1.6.2]# ./configure          #&lt;==ç¼–è¯‘ï¼Œæ­¤å‰å…ˆç¡®ä¿å®‰è£…cmakeç­‰ç¼–è¯‘å·¥å…·
[root@kafka01 cronolog-1.6.2]# make &amp;&amp; make install #&lt;==å®‰è£…
[root@kafka01 cronolog-1.6.2]# which cronolog       #&lt;==æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸï¼Œå¦‚æœæœ‰ç»“æœåˆ™å®‰è£…æˆåŠŸ
/usr/local/sbin/cronolog
</code></pre>
<ul>
<li>cronologå‘½ä»¤</li>
</ul>
<pre><code class="language-bash">[root@server1 ~]# which cronolog
/usr/local/sbin/cronolog            #&lt;==cronologå‘½ä»¤çš„å­˜æ”¾è·¯å¾„
ä½¿ç”¨manå¸®åŠ©å‘½ä»¤æŸ¥çœ‹cronologä½¿ç”¨è¯­æ³•ï¼š
[root@server1 ~]# man cronolog
NAME
       cronolog - write log messages to log files named according to a template
 
SYNOPSIS
       cronolog [OPTION]... template
</code></pre>
<h3 id="2-é…ç½®tomcatæ—¥å¿—åˆ‡å‰²">2. é…ç½®tomcatæ—¥å¿—åˆ‡å‰²</h3>
<p>é…ç½®æ—¥å¿—åˆ‡å‰²ï¼Œåªéœ€ä¿®æ”¹é…ç½®æ–‡ä»¶catalina.shï¼ˆå¦‚æœwindowsåˆ™æ˜¯catalina.batï¼Œè¿™é‡Œä¸ä»‹ç»windowsæƒ…å†µï¼‰å³å¯ã€‚å¤§æ¦‚åœ¨catalinaæ–‡ä»¶ä¸­çš„ç¬¬380è¡Œå’Œç¬¬390è¡Œå·¦å³ï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<p>ï¼ˆ1ï¼‰å†…å®¹ï¼š</p>
<pre><code class="language-sh">org.apache.catalina.startup.Bootstrap &quot;$@&quot; start \
&gt;&gt; &quot;$CATALINA_OUT&quot; 2&gt;&amp;1 &quot;&amp;&quot;
</code></pre>
<p>æ›¿æ¢ä¸ºï¼š</p>
<pre><code class="language-sh">org.apache.catalina.startup.Bootstrap &quot;$@&quot; start \
2&gt;&amp;1 |/usr/local/sbin/cronolog &quot;$CATALINA_BASE/logs/catalina-%Y-%m-%d.out&quot; &amp;
</code></pre>
<p>ï¼ˆ2ï¼‰å†…å®¹ï¼š</p>
<pre><code class="language-sh">org.apache.catalina.startup.Bootstrap &quot;$@&quot; start \
&gt;&gt; &quot;$CATALINA_OUT&quot; 2&gt;&amp;1 &quot;&amp;&quot;
</code></pre>
<p>æ›¿æ¢ä¸ºï¼š</p>
<pre><code class="language-sh">org.apache.catalina.startup.Bootstrap &quot;$@&quot; start \
2&gt;&amp;1 |/usr/local/sbin/cronolog &quot;$CATALINA_BASE/logs/catalina-%Y-%m-%d.out&quot; &amp;
</code></pre>
<p><img src="https://luckynum.github.io/post-images/1555989728476.png" alt=""></p>
<p>é…ç½®å®Œæˆåï¼Œé‡å¯tomcatå³å¯ï¼</p>
<h3 id="3å®šæ—¶åˆ é™¤-å¤‡ä»½è¿‡æœŸæ—¥å¿—">3.å®šæ—¶åˆ é™¤ã€å¤‡ä»½è¿‡æœŸæ—¥å¿—</h3>
<p>åœ¨è¿™é‡Œç›´æ¥ä½¿ç”¨linuxè‡ªå¸¦çš„crontabå®šæ—¶ä»»åŠ¡å·¥å…·ï¼Œè®¾ç½®æ¯å¤©å‡Œæ™¨00:00æ‰§è¡Œåˆ é™¤ä»»åŠ¡ï¼Œåˆ é™¤7å¤©ä»¥å‰çš„æ—¥å¿—æ–‡ä»¶ã€‚</p>
<p>åˆ é™¤</p>
<pre><code class="language-bash">[root@server1 ~]# crontab -e          #&lt;==ç›´æ¥è¾“å…¥è¯¥å‘½ä»¤ï¼Œæ·»åŠ ä¸€ä¸ªå®šæ—¶ä»»åŠ¡è®¡åˆ’
00 00 * * * /bin/find /opt/gdyy/tomcat7/logs/ -type f -mtime +7 | xargs rm -f  &amp;&gt;/dev/null  #&lt;==æŸ¥æ‰¾tomcat/logsä¸‹é¢çš„æ—¥å¿—æ–‡ä»¶ï¼Œå¹¶åˆ é™¤7å¤©ä»¥å‰çš„æ—¥å¿—ï¼Œæ·»åŠ å®Œæˆåä¿å­˜é€€å‡ºï¼ï¼
</code></pre>
<p>å¤‡ä»½</p>
<pre><code class="language-bash">[root@server1 ~]# crontab -l    #&lt;==æŸ¥çœ‹å®šæ—¶ä»»åŠ¡è®¡åˆ’
#remove gw log 7 days ago by liutao at 2018-02-08
00 00 * * * /bin/find /opt/gw/tomcat7/logs/ -type f -mtime +7 | xargs -i mv {} /data/bak/gw_log/  &amp;&gt;/dev/null
</code></pre>

          </div>
        </div>

        
          <div class="next-post">
            <a class="purple-link" href="https://luckynum.github.io/post/nginx-an-zhuang">
              <h3 class="post-title">
                ä¸‹ä¸€ç¯‡ï¼šNginx - å®‰è£…
              </h3>
            </a>
          </div>
          
      </div>

      

      <div class="site-footer">
  <div class="slogan">Hello, World!</div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
</div>


    </div>
    <script type="application/javascript">

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>




  </body>
</html>
